<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Wish List</title>
    <script>
        window.onerror = function (msg, url, lineNo, columnNo, error) {
            if (msg.includes('speed-insights') || msg.includes('Script error')) return false;
            alert("üî• CRITICAL ERROR üî•\n" + msg + "\nLine: " + lineNo);
            return false;
        };
    </script>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <link rel="stylesheet" href="style.css?v=10.1.6">
    <!-- Telegram WebApp Script -->
    <script src="https://telegram.org/js/telegram-web-app.js?v=10.1.6"></script>
    <!-- Main Script -->
    <script src="main.js?v=10.1.6" defer></script>
    <script>
        // URGE UNREGISTER SERVICE WORKERS
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(function (registrations) {
                for (let registration of registrations) {
                    registration.unregister();
                }
            });
        }
    </script>
</head>

<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <button class="icon-btn header-back-btn hidden" id="header-back-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="back-icon" stroke="currentColor"
                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M19 12H5" />
                    <path d="M12 19l-7-7 7-7" />
                </svg>
            </button>
            <div class="user-info" id="header-user-info">
                <div class="brand-logo">
                    <div class="heart-icon">‚ù§Ô∏è</div>
                </div>
                <div class="brand-text">
                    <span class="brand-merci">Merci</span> <span class="brand-divider">/</span> <span
                        class="brand-wish">Wish list</span> <span style="font-size: 10px; opacity: 0.5;">v10.1.6</span>
                </div>
            </div>
            <h1 class="header-title hidden" id="header-title"></h1>
            <button class="icon-btn hidden" id="header-action-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M18 8C19.6569 8 21 6.65685 21 5C21 3.34315 19.6569 2 18 2C16.3431 2 15 3.34315 15 5C15 6.65685 16.3431 8 18 8Z"
                        stroke="currentColor" stroke-width="2" />
                    <path
                        d="M6 15C7.65685 15 9 13.6569 9 12C9 10.3431 7.65685 9 6 9C4.34315 9 3 10.3431 3 12C3 13.6569 4.34315 15 6 15Z"
                        stroke="currentColor" stroke-width="2" />
                </svg>
            </button>
        </header>

        <!-- Main Content -->
        <main class="content-area" id="home-view">
            <!-- Categories -->
            <div class="categories"
                style="margin-bottom: 20px; overflow-x: auto; white-space: nowrap; padding-bottom: 5px;">
                <button class="cat-pill active" data-cat="–í—Å–µ">–í—Å–µ</button>
                <button class="cat-pill" data-cat="–ù–æ–≤—ã–π –≥–æ–¥">–ù–æ–≤—ã–π –≥–æ–¥ üéÑ</button>
                <button class="cat-pill" data-cat="14 –§–µ–≤—Ä–∞–ª—è">14 –§–µ–≤—Ä–∞–ª—è üíò</button>
                <button class="cat-pill" data-cat="8 –ú–∞—Ä—Ç–∞">8 –ú–∞—Ä—Ç–∞ üå∑</button>
                <button class="cat-pill" data-cat="–î–µ–Ω—å –†–æ–∂–¥–µ–Ω–∏—è">–î–µ–Ω—å –†–æ–∂–¥–µ–Ω–∏—è üéÇ</button>
                <button class="cat-pill" data-cat="–†–∞–∑–Ω–æ–µ">–†–∞–∑–Ω–æ–µ ‚ú®</button>
            </div>

            <!-- Shops Carousel (Circle Design) -->
            <!-- Shops Carousel (Circle Design) - REMOVED BY USER REQUEST
            <div class="shops-carousel-container">
                <div class="shop-item" id="subscriptions-btn">
                    <div class="shop-logo-wrapper">
                        <div class="shop-logo sub-gradient">
                            <span style="font-size: 24px;">üé´</span>
                        </div>
                    </div>
                    <span>–ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã</span>
                </div>

                <div class="shop-item">
                    <div class="shop-logo-wrapper">
                        <img src="logos/meloman.png" class="shop-logo-img" alt="Meloman">
                    </div>
                    <span>Meloman</span>
                </div>

                <div class="shop-item">
                    <div class="shop-logo-wrapper">
                        <img src="logos/goldapple.png" class="shop-logo-img" alt="Gold Apple">
                    </div>
                    <span>–ó–æ–ª–æ—Ç–æ–µ –Ø–±–ª–æ–∫–æ</span>
                </div>

                <div class="shop-item">
                    <div class="shop-logo-wrapper">
                        <img src="logos/kaspi.png" class="shop-logo-img" alt="Kaspi">
                    </div>
                    <span>Kaspi.kz</span>
                </div>

                <div class="shop-item">
                    <div class="shop-logo-wrapper">
                        <img src="logos/technodom.png" class="shop-logo-img" alt="Technodom">
                    </div>
                    <span>Technodom</span>
                </div>

                <div class="shop-item">
                    <div class="shop-logo-wrapper">
                        <img src="logos/1fit.png" class="shop-logo-img" alt="1Fit">
                    </div>
                    <span>1Fit</span>
                </div>
            </div>
            -->

            <!-- SHARE BUTTON REMOVED BY USER REQUEST -->


            <!-- MAIN CONTENT (WISH LIST) -->
            <div id="wish-list-container" class="grid-container" style="margin-top: 20px;">
                <!-- Items will be injected here -->
            </div>
        </main>

        <div class="content-area hidden" id="create-view">
            <div class="create-step-1">
                <div class="create-header">
                    <h2>–î–æ–±–∞–≤–∏—Ç—å –∂–µ–ª–∞–Ω–∏–µ</h2>
                    <p>–í—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–æ–≤–∞—Ä –∏–∑ Kaspi.kz</p>
                </div>

                <div class="url-input-container">
                    <div class="input-icon-wrapper">
                        <svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2">
                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                        </svg>
                        <input type="url" id="kaspi-link" placeholder="https://kaspi.kz/shop/..." class="styled-input">
                    </div>
                    <button id="parse-link-btn" class="btn btn-primary full-width" disabled>–î–∞–ª–µ–µ</button>
                </div>
            </div>

            <!-- Hidden Step 2: Confirm Details -->
            <div class="create-step-2 hidden" id="create-step-2">
                <div class="preview-image-upload">
                    <img src="" id="new-item-image" alt="Preview">
                    <div class="upload-btn-overlay">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="17 8 12 3 7 8"></polyline>
                            <line x1="12" y1="3" x2="12" y2="15"></line>
                        </svg>
                    </div>
                </div>

                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                    <input type="text" id="new-item-title" class="styled-input">
                </div>

                <div class="form-group">
                    <label>–°—Ç–æ–∏–º–æ—Å—Ç—å (‚Ç∏)</label>
                    <input type="number" id="new-item-price" class="styled-input">
                </div>

                <div class="form-group">
                    <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select id="new-item-category" class="styled-input" style="appearance: none;">
                        <option value="–†–∞–∑–Ω–æ–µ">–†–∞–∑–Ω–æ–µ ‚ú®</option>
                        <option value="–ù–æ–≤—ã–π –≥–æ–¥">–ù–æ–≤—ã–π –≥–æ–¥ üéÑ</option>
                        <option value="14 –§–µ–≤—Ä–∞–ª—è">14 –§–µ–≤—Ä–∞–ª—è üíò</option>
                        <option value="8 –ú–∞—Ä—Ç–∞">8 –ú–∞—Ä—Ç–∞ üå∑</option>
                        <option value="–î–µ–Ω—å –†–æ–∂–¥–µ–Ω–∏—è">–î–µ–Ω—å –†–æ–∂–¥–µ–Ω–∏—è üéÇ</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>–í–∏–¥–∏–º–æ—Å—Ç—å</label>
                    <select id="new-item-visibility" class="styled-input" style="appearance: none;">
                        <option value="public">–î–ª—è –≤—Å–µ—Ö üåç</option>
                        <option value="private">–¢–æ–ª—å–∫–æ –º–Ω–µ üîí</option>
                    </select>
                </div>

                <button id="confirm-create-btn" class="btn btn-primary full-width">–°–æ–∑–¥–∞—Ç—å</button>
                <button id="cancel-create-btn" class="btn btn-text full-width">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>



        <!-- PROFILE VIEW (Users/Rating) -->
        <div id="profile-view" class="view-section hidden">
            <div class="section-header" style="margin-top: 0;">
                <h3>–©–µ–¥—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ üèÜ</h3>
            </div>
            <div id="generous-users-list" class="users-list">
                <!-- Populated by JS -->
            </div>
        </div>

        <!-- TASKS VIEW -->
        <div id="tasks-view" class="view-section hidden">
            <div class="tasks-header">
                <div class="tasks-avatar-container">
                    <div class="tasks-avatar-ring"></div>
                    <img src="https://cdn-icons-png.flaticon.com/512/9417/9417652.png" alt="Tasks" class="tasks-avatar">
                </div>
                <h2 class="tasks-name">–ó–∞–¥–∞–Ω–∏—è</h2>
                <p class="tasks-bio">–í—ã–ø–æ–ª–Ω—è–π –∑–∞–¥–∞–Ω–∏—è –∏ –ø–æ–ª—É—á–∞–π —Å–ª–æ—Ç—ã üéÅ</p>
            </div>

            <div class="tasks-container" id="tasks-list">
                <!-- Tasks will be rendered here -->
            </div>
        </div>

        <!-- PERSONAL PROFILE VIEW (Instagram Style) -->
        <div id="user-profile-view" class="content-area hidden">
            <!-- Top Header: Avatar + Stats -->
            <div class="insta-header">
                <div class="insta-avatar-container">
                    <img src="" id="profile-avatar" alt="Avatar" class="insta-avatar">
                    <!-- <button class="edit-badge" id="edit-avatar-btn">+</button> -->
                </div>

                <div class="insta-stats-container">
                    <div class="insta-stat">
                        <span class="stat-val" id="stat-wishes">0</span>
                        <span class="stat-label">–ñ–µ–ª–∞–Ω–∏–π</span>
                    </div>
                    <div class="insta-stat">
                        <span class="stat-val" id="stat-subscribers">0</span>
                        <span class="stat-label">–ü–æ–¥–ø–∏—Å—á–∏–∫–∏</span>
                    </div>
                    <div class="insta-stat">
                        <span class="stat-val">0</span>
                        <span class="stat-label">–ü–æ–¥–ø–∏—Å–∫–∏</span>
                    </div>
                </div>
            </div>

            <!-- Wallet Card (TikTok Style) -->
            <div class="wallet-card">
                <div class="wallet-balance">
                    <span class="wallet-label">–ë–∞–ª–∞–Ω—Å</span>
                    <span class="wallet-amount" id="user-balance-display">0 ‚Ç∏</span>
                </div>
                <div class="wallet-actions">
                    <button class="btn-topup" id="wallet-topup-btn">–ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
                </div>
            </div>

            <!-- Bio Section -->
            <div class="insta-bio-section">
                <h2 id="profile-name">Name</h2>
                <p id="profile-bio">Bio</p>
            </div>

            <!-- Action Buttons -->
            <div class="insta-actions">
                <button class="btn-insta-edit" id="edit-profile-btn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>

            <!-- Guest Wish List Container -->
            <div id="guest-wish-list-container" class="grid-container" style="padding-bottom: 80px; padding-top: 20px;">
                <!-- Guest items will be injected here -->
            </div>

            <!-- Highlights / Settings -->
            <div class="insta-settings-group">
                <!-- Settings Removed -->

                <!-- Donation Link -->
                <!-- Donation Button -->
                <button id="donate-dev-btn" class="btn btn-gold">
                    <span>üéÅ –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞</span>
                </button>
            </div>
        </div>

        <!-- Public View Banner Removed by User Request -->

        <!-- Locked Content Overlay (for Public View) -->
        <div id="locked-overlay" class="hidden">
            <div class="locked-content">
                <div class="lock-icon">üîí</div>
                <h3>–ü—Ä–æ—Ñ–∏–ª—å –∑–∞–∫—Ä—ã—Ç</h3>
                <p>–ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å–ø–∏—Å–æ–∫ –∂–µ–ª–∞–Ω–∏–π</p>
                <button class="btn btn-primary" id="subscribe-btn">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
            </div>
            ```
            <div class="header-right">
                <!-- <button class="btn-icon">üîî</button> -->
                <button class="btn-icon" id="main-settings-btn">‚öôÔ∏è</button>
            </div>
        </div>
    </div>

    <!-- SANTA VIEW REMOVED -->
    <!-- SANTA VIEW GONE -->

    <!-- Payment Modal (Refactored) -->
    <div id="payment-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal">&times;</button>
            <h3>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞</h3>

            <div class="amount-input-wrapper">
                <input type="number" id="payment-amount" placeholder="5000" class="amount-input">
                <span class="currency-label">‚Ç∏</span>
            </div>

            <!-- Spend Balance Button (Only for Donate Mode) -->
            <button id="pay-from-wallet-btn" class="btn btn-primary full-width hidden" style="margin-top: 20px;">
                –û–ø–ª–∞—Ç–∏—Ç—å —Å –±–∞–ª–∞–Ω—Å–∞
            </button>

            <p style="margin-top: 20px; color: #888; font-size: 14px;" id="pay-methods-title">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:
            </p>

            <div class="payment-methods-grid" id="payment-methods-grid">
                <!-- Apple Pay (Telegram Integration) -->
                <div class="pay-method-btn" id="pay-method-apple">
                    <span class="pay-method-icon">Ô£ø</span>
                    <span class="pay-method-label">Apple Pay</span>
                </div>

                <!-- USDT -->
                <div class="pay-method-btn" id="pay-method-usdt">
                    <span class="pay-method-icon">‚ÇÆ</span>
                    <span class="pay-method-label">USDT (TRC20)</span>
                </div>

                <!-- Bank Card (Generic) -->
                <div class="pay-method-btn" id="pay-method-card">
                    <span class="pay-method-icon">üí≥</span>
                    <span class="pay-method-label">–ö–∞—Ä—Ç–∞</span>
                </div>
            </div>

            <!-- Hint Area -->
            <div id="payment-hint-area"
                style="margin-top: 15px; font-size: 13px; color: #aaa; text-align: center; min-height: 20px;">
                –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ Telegram Stars / Wallet
            </div>
        </div>
    </div>
    </div>

    <!-- Limit Reached Modal -->
    <div id="limit-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal close-limit-modal">&times;</button>
            <h3>–°–ª–æ—Ç—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å! üîí</h3>
            <p>–ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –∂–µ–ª–∞–Ω–∏–π, –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –∑–∞–¥–∞–Ω–∏—è –∏ –ø—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π.</p>
            <div style="margin-top: 20px;">
                <button id="go-to-tasks-btn" class="btn btn-primary full-width">–ü–µ—Ä–µ–π—Ç–∏ –∫ –∑–∞–¥–∞–Ω–∏—è–º</button>
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div id="share-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal close-share-modal">&times;</button>
            <h3>–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤–∏—à–ª–∏—Å—Ç–æ–º üéÅ</h3>
            <p>–û—Ç–ø—Ä–∞–≤—å —ç—Ç—É —Å—Å—ã–ª–∫—É –¥—Ä—É–∑—å—è–º, —á—Ç–æ–±—ã –æ–Ω–∏ —É–≤–∏–¥–µ–ª–∏ —Ç–≤–æ–∏ –∂–µ–ª–∞–Ω–∏—è!</p>

            <div class="share-link-wrapper">
                <input type="text" id="share-link-input" readonly value="...">
                <button id="copy-link-btn" class="btn-icon">üìã</button>
            </div>

            <button id="share-telegram-btn" class="btn btn-primary full-width" style="margin-top: 15px;">
                ‚úàÔ∏è –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram
            </button>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <button class="nav-item active" data-target="home-view">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="heart-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#FF9A9E;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#FECFEF;stop-opacity:1" />
                    </linearGradient>
                </defs>
                <path
                    d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"
                    fill="url(#heart-gradient)" stroke="none" />
            </svg>
            <span
                style="background: linear-gradient(90deg, #ff9a9e 0%, #fecfef 100%); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 600;">My</span>
        </button>
        <!-- SANTA TAB REMOVED -->
        <button class="nav-item" data-target="tasks-view">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 11l3 3L22 4" />
                <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1-2-2h11" />
            </svg>
            <span>–ó–∞–¥–∞–Ω–∏—è</span>
        </button>
        <div class="fab-container">
            <button class="nav-item fab-wrapper" data-target="create-view">
                <div class="fab">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
                        stroke-linecap="round" stroke-linejoin="round">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                </div>
            </button>
        </div>
        <button class="nav-item" data-target="profile-view">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="cup-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#ffe259;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#ffa751;stop-opacity:1" />
                    </linearGradient>
                </defs>
                <path
                    d="M19 5h-2V3a1 1 0 0 0-1-1h-8a1 1 0 0 0-1 1v2H5a3 3 0 0 0-3 3v2a6 6 0 0 0 6 6h.17A6.45 6.45 0 0 0 11 18.89V21H9a1 1 0 0 0 0 2h6a1 1 0 0 0 0-2h-2v-2.11A6.45 6.45 0 0 0 15.83 16h.17a6 6 0 0 0 6-6V8a3 3 0 0 0-3-3zM8 10V5h2v5a2 2 0 0 1-2 0zm6 0a2 2 0 0 1-2 0V5h2zM4 10V8a1 1 0 0 1 1-1h2v5a4 4 0 0 1-3-3.86zm11 3.86a4 4 0 0 1-3 0V5h2a1 1 0 0 1 1 1v2z"
                    fill="url(#cup-gradient)" stroke="none" />
            </svg>
            <span
                style="background: linear-gradient(90deg, #ffe259 0%, #ffa751 100%); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 600;">–†–µ–π—Ç–∏–Ω–≥</span>
        </button>
        <button class="nav-item" data-target="user-profile-view">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
        </button>
    </nav>
    </div>
    <!-- Vercel Speed Insights -->
    <script type="module">
        import { injectSpeedInsights } from '@vercel/speed-insights';
        injectSpeedInsights();
    </script>
    <script src="main.js?v=9.9.82"></script>
</body>

</html>